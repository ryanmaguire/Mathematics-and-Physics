\documentclass[crop=false,class=book,oneside]{standalone}
%----------------------------Preamble-------------------------------%
\input{../../../preamble.tex}                                       %
%--------------------------Main Document----------------------------%
\begin{document}
    \ifx\ifplanetdiff\undefined
        \title{Geometry}
        \author{Ryan Maguire}
        \date{\vspace{-5ex}}
        \maketitle
        \tableofcontents
        \clearpage
        \chapter{Geometry}
        \setcounter{chapter}{2}
    \else
        \chapter{Geometry}
    \fi
    \section{Titan Geometry}
        \begin{figure}[H]
        	\centering
        	\captionsetup{type=figure}
        	\begin{subfigure}[b]{0.49\textwidth}
        	    \centering
        	    \captionsetup{type=figure}
        	    \resizebox{\textwidth}{!}{
                    \subimport{../../../tikz/}
                              {Titan_Occultation_Geometry}}
            	\subcaption{Geometry of an Occultation of Titan}
        	    \label{fig:math_titan_geom_vec}
            \end{subfigure}
            \begin{subfigure}[b]{0.49\textwidth}
                \centering
                \captionsetup{type=figure}
                \resizebox{\textwidth}{!}{
                \subimport{../../../tikz/}
                          {Titan_Bending_Angle_Geometry}}
                \subcaption{Geometry of the Bending Angle}
                \label{fig:math_geo_bending_angle}
            \end{subfigure}
            \caption{Various Geometries for Titan}
        \end{figure}
        The following definitions are used:
        \begin{enumerate}
            \begin{multicols}{2}
                \item $O$ is the center of Titan.
                \item $E$ is the Earth.
                \item $C$ is the Cassini spacecraft.
                \item $\mathbf{r}_{E}=\overrightarrow{OE}$
                \item $\mathbf{v}_{E}=\dot{\mathbf{r}}_{E}$
                \item $\mathbf{r}_{S}=\overrightarrow{OC}$
                \item $\mathbf{v}_{S}=\dot{\mathbf{r}}_{S}$
                \item $\mathbf{p}_{in}$ is the projection of
                      $O$ onto $\overline{AC}$
                \item $\mathbf{p}_{out}$ is the projection
                      of $O$ onto $\overline{EA}$
                \item $\alpha$ is the bending angle
                      ($\pi-\angle EAC$)
                \item $\hat{\mathbf{n}}_{in}$ is the
                      direction of the emission.
                \item $\hat{\mathbf{n}}_{out}$ is the
                      direction of the reception.
                \item The ray plane lies in the plane $OEC$
                \item $\phi=\angle{AOC}$
                \item $\theta=\angle{ACO}$
                \item $\beta=\angle{OAC}$
            \end{multicols}

            % Multicols adds 6pt a vspace.
            \vspace{-6pt}
            \item $A$ is the intersection of the lines
                  starting at $C$ and $E$, parallel to
                  $\hat{\mathbf{n}}_{in}$ and
                  $\hat{\mathbf{n}}_{out}$, respectively.
        \end{enumerate}

        % Replace the 6pt vspace removed to below the list.
        \vspace{6pt}
        Where $\dot{\mathbf{r}}$ denotes the time derivative
        of $\mathbf{r}$. The following assumptions are made:
        \begin{enumerate}
            \begin{multicols}{2}
                \item $\angle{OAE}=\angle{OAC}$
                \item $A$ lies in the plane $OEC$
            \end{multicols}
        \end{enumerate}
        \begin{theorem}
            \label{theorem:ray_plane_perp_to_r_e_cross_r_s}
            The ray plane is perpendicular to
            $\hat{\mathbf{z}}%
             =\frac{\mathbf{r}_{S}\times
             \mathbf{r}_{E}}{\norm{\mathbf{r}_{S}\times
             \mathbf{r}_{E}}}$
        \end{theorem}
        \begin{proof}
            As the ray plane is the plane $OEC$,
            $\mathbf{r}_{S}$ and $\mathbf{r}_{E}$ lie parallel
            to this plane. Moreover, during an occultation,
            $\mathbf{r}_{S}$ and $\mathbf{r}_{E}$ are not
            parallel and therefore $OEC$ is uniquely determined
            by $\mathbf{r}_{E}$, $\mathbf{r}_{S}$, and the point
            $O$. But
            $\hat{\mathbf{z}}%
             =\frac{\mathbf{r}_{S}\times
             \mathbf{r}_{E}}{\norm{\mathbf{r}_{S}\times
             \mathbf{r}_{E}}}$
            is perpendicular to both $\mathbf{r}_{E}$ and
            $\mathbf{r}_{S}$. Therefore $\hat{\mathbf{z}}$ is
            perpendicular to the ray plane.
        \end{proof}
        \begin{theorem}
            \label{theorem:r_e_dot_p_out_equal_p_out_square}
            $\mathbf{r}_{E}\cdot\mathbf{p}_{out}%
             =\norm{\mathbf{p}_{out}}^{2}$
        \end{theorem}
        \begin{proof}
            $\mathbf{p}_{out}$ is the projection of the $O$
            onto $\overline{EA}$. But $\overline{EA}$ lies
            parallel to $\hat{\mathbf{n}}_{out}$, and
            therefore $\mathbf{p}_{out}$ and
            $\hat{\mathbf{n}}_{out}$ are orthogonal,
            and thus
            $\mathbf{p}_{out}\cdot\hat{\mathbf{n}}_{out}=0$.
            Moreoever,
            $\mathbf{r}_{E}%
             =\mathbf{p}_{out}+(\mathbf{r}_{E}\cdot
             \hat{\mathbf{n}}_{out}) \hat{\mathbf{n}}_{out}$.
            But then:
            \begin{align*}
                \mathbf{p}_{out}\cdot \mathbf{r}_{E}
                &=\mathbf{p}_{out}\cdot\big(
                    \mathbf{p}_{out}
                    +(\mathbf{r}_{E}\cdot
                    \hat{\mathbf{n}}_{out})
                    \hat{\mathbf{n}}_{out}
                \big)\\
                \Rightarrow\mathbf{p}_{out}\cdot \mathbf{r}_{E}
                &=\mathbf{p}_{out}\cdot\mathbf{p}_{out}
                 +(\mathbf{r}_{E}\cdot\hat{\mathbf{n}}_{out})
                  \mathbf{p}_{out}\cdot \hat{\mathbf{n}}_{out}\\
                \Rightarrow\mathbf{p}_{out}\cdot\mathbf{r}_{E}
                &=\mathbf{p}_{out}\cdot\mathbf{p}_{out}
            \end{align*}
            Therefore
            $\mathbf{p}_{out}\cdot\mathbf{r}_{E}%
             =\norm{\mathbf{p}_{out}}^{2}$
        \end{proof}
        \begin{theorem}
            $\alpha%
             =\cos^{-1}(\hat{\mathbf{n}}_{in}
              \cdot\hat{\mathbf{n}}_{out})$
        \end{theorem}
        \begin{proof}
            By definition,
            $\alpha=\pi-\angle{EAC}$.
            But $\hat{\mathbf{n}}_{out}$ lies parallel to
            $\overrightarrow{AE}$, and $-\hat{\mathbf{n}}_{in}$
            lies parallel to $\overrightarrow{AC}$. Therefore:
            \begin{equation*}
                -\hat{\mathbf{n}}_{out}\cdot
                 \hat{\mathbf{n}}_{in}
                =\hat{\mathbf{n}}_{out}\cdot
                 (-\hat{\mathbf{n}}_{in})
                =\norm{\hat{\mathbf{n}}_{out}}
                 \norm{-\hat{\mathbf{n}}_{in}}\cos(\angle{EAC})
            \end{equation*}
            But $\hat{\mathbf{n}}_{in}$ and
            $\hat{\mathbf{n}}_{out}$ are unit vectors,
            and therefore
            $\norm{\hat{\mathbf{n}}_{out}}%
             =\norm{-\hat{\mathbf{n}}_{in}}=1$.
            Therefore:
            \begin{equation*}
                \angle EAC
                =\cos^{-1}(
                    -\hat{\mathbf{n}}_{out}\cdot
                    \hat{\mathbf{n}}_{in}
                )
            \end{equation*}
            But $\alpha=\pi-\angle{EAC}$,
            and $\cos^{-1}(-x)=\pi-\cos^{-1}(x)$.
            Therefore:
            \begin{equation*}
                \alpha=\pi-\angle{EAC}
                =\pi-\big(
                    \pi-\cos^{-1}(\hat{\mathbf{n}}_{out}\cdot
                    \hat{\mathbf{n}}_{in})
                \big)
                =\cos^{-1}(\hat{\mathbf{n}}_{out}\cdot
                 \hat{\mathbf{n}}_{in})
            \end{equation*}
        \end{proof}
        \begin{theorem}
            $\theta%
             =\cos^{-1}\big(%
                  \frac{(-\mathbf{r}_{S})\cdot%
                  \hat{\mathbf{n}}_{in}}{\norm{\mathbf{r}_{S}}}%
              \big)$
        \end{theorem}
        \begin{proof}
            For $\theta=\angle OCA$.
            But $\hat{\mathbf{n}}_{in}$ is parallel with
            $\overrightarrow{CA}$, and $(-\mathbf{r}_{S})$
            is parallel with $\overrightarrow{CO}$.
            Therefore:
            \begin{align*}
                (-\mathbf{r}_{S})\cdot\hat{\mathbf{n}}_{in}
                &=\norm{(-\mathbf{r}_{S})}
                  \norm{\hat{\mathbf{n}}_{in}}\cos(\theta)\\
                \Rightarrow\theta
                &=\cos^{-1}\bigg(
                    \frac{%
                        (-\mathbf{r}_{S})\cdot
                        \hat{\mathbf{n}}_{in}
                    }{\norm{\mathbf{r}_{S}}}
                \bigg)
            \end{align*}
        \end{proof}
        \begin{theorem}
            \begin{equation*}
                \beta=\pi-\frac{1}{2}\cos^{-1}
                \Big(\frac{\mathbf{r}_{s}
                     \cdot\mathbf{r}_{E}}
                     {\norm{\mathbf{r}_{s}}
                     \norm{\mathbf{r}_{E}}}\Big)
                -\frac{1}{2}\cos^{-1}
                \Big(\frac{\mathbf{r}_{E}\cdot
                           \hat{\mathbf{n}}_{out}}
                          {\norm{\mathbf{r}_{E}}}\Big)
                -\frac{1}{2}\cos^{-1}
                \Big(\frac{(-\mathbf{r}_{s})\cdot
                           \hat{\mathbf{n}}_{in}}
                          {\norm{\mathbf{r}_{s}}}\Big)
            \end{equation*}
        \end{theorem}
        \begin{proof}
            The sum of the angles in $OEAC$ is $2\pi$.
            But
            $\angle{OAE}=\angle{OAC}=\phi$, and therefore:
            \begin{align*}
                2\beta&=\angle{EAC}\\
                \Rightarrow
                2\pi
                &=2\beta+\angle{AEO}
                 +\angle{EOC}+\angle{OCA}\\
                \Rightarrow\beta
                &=\pi-\frac{\angle{AEO}}{2}
                 -\frac{\angle EOC}{2}-\frac{\angle OCA}{2}
            \end{align*}
            But:
            \begin{align*}
                (-\hat{\mathbf{n}}_{out})\cdot
                (-\hat{\mathbf{r}}_{E})
                &=\norm{\mathbf{r}_{E}}\cos(\angle AEO)\\
                \Rightarrow\angle{AEO}
                &=\cos^{-1}\bigg(
                    \frac{
                        \hat{\mathbf{n}}_{out}\cdot
                        \mathbf{r}_{E}
                    }{\norm{\mathbf{r}_{E}}}
                \bigg)
            \end{align*}
            Also:
            \begin{align*}
                \mathbf{r}_{E}\cdot\mathbf{r}_{S}
                &=\norm{\mathbf{r}_{E}}
                  \norm{\mathbf{r}_{S}}\cos(\angle EOC)\\
                \Rightarrow\angle{EOC}
                &=\cos^{-1}
                  \bigg(
                      \frac{
                          \mathbf{r}_{E}\cdot
                          \mathbf{r}_{S}
                      }{
                          \norm{\mathbf{r}_{E}}
                          \norm{\mathbf{r}_{S}}
                      }
                  \bigg)
            \end{align*}
            But
            $\angle{OCA}%
             =\theta%
             =\cos^{-1}%
              \big(\frac{%
                       (-\mathbf{r}_{S})\cdot%
                       \hat{\mathbf{n}}_{in}%
                   }{\norm{\mathbf{r}_{S}}}%
              \big)$.
            Therefore:
            \begin{equation*}
                \beta=\pi-\frac{1}{2}\cos^{-1}
                    \bigg(
                        \frac{
                            \mathbf{r}_{s}\cdot
                            \mathbf{r}_{E}
                        }{
                            \norm{\mathbf{r}_{s}}
                            \norm{\mathbf{r}_{E}}
                        }
                    \bigg)
                    -\frac{1}{2}\cos^{-1}
                    \bigg(
                        \frac{
                            \mathbf{r}_{E}\cdot
                            \hat{\mathbf{n}}_{out}
                        }{
                            \norm{\mathbf{r}_{E}}
                        }
                    \bigg)
                    -\frac{1}{2}\cos^{-1}
                    \bigg(
                        \frac{
                            (-\mathbf{r}_{s})\cdot
                            \hat{\mathbf{n}}_{in}
                        }{
                            \norm{\mathbf{r}_{s}}
                        }
                    \bigg)
            \end{equation*}
        \end{proof}
        \begin{theorem}
            $\alpha=\pi-2\beta$
        \end{theorem}
        \begin{proof}
            $\alpha$ and $\angle EAC$ are supplementary to
            the ray $\overrightarrow{CA}$, and therefore
            $\alpha+\angle EAC=\pi$.
            But $\angle{EAC}=\angle{EAC}+\angle{OAC}=2\beta$.
            Therefore $\alpha+2\beta=\pi$.
            Thus, $\alpha=\pi-2\beta$.
        \end{proof}
        \begin{theorem}
            $\theta=\frac{\pi}{2}+\frac{\alpha}{2}-\phi$
        \end{theorem}
        \begin{proof}
            As the angles of a triangle sum to $\pi$,
            $\theta+\beta+\phi=\pi$. But 
            $\alpha=\pi-2\beta\Rightarrow\beta%
             =\frac{\pi}{2}-\frac{\alpha}{2}$.
            So we have:
            \begin{align*}
                \theta+\phi+\beta
                &=\pi\\
                \Rightarrow
                \theta+\phi+\frac{\pi}{2}-\frac{\alpha}{2}
                &=\pi\\
                \Rightarrow\theta
                &=\frac{\pi}{2}+\frac{\alpha}{2}-\phi
            \end{align*}
        \end{proof}
        \begin{theorem}
            \begin{equation*}
                \phi=\frac{1}{2}\cos^{-1}
                    \Big(\frac{\mathbf{r}_{s}\cdot
                               \mathbf{r}_{E}}
                              {\norm{\mathbf{r}_{s}}
                               \norm{\mathbf{r}_{E}}}\Big)
                +\frac{1}{2}\cos^{-1}
                \Big(\frac{\mathbf{r}_{E}\cdot
                           \hat{\mathbf{n}}_{out}}
                          {\norm{\mathbf{r}_{E}}}\Big)
                -\frac{1}{2}\cos^{-1}
                \Big(\frac{(-\mathbf{r}_{s})\cdot
                           \hat{\mathbf{n}}_{in}}
                          {\norm{\mathbf{r}_{s}}}\Big)
            \end{equation*}
        \end{theorem}
        \begin{proof}
            For:
            \begin{align*}
                \pi&=\beta+\theta+\phi\\
                \theta
                &=\cos^{-1}
                    \bigg(
                        \frac{
                            (-\mathbf{r}_{S})\cdot
                            \hat{\mathbf{n}}_{in}
                        }{\norm{\mathbf{r}_{S}}}
                    \bigg)\\
                \beta&= \pi-\frac{1}{2}\cos^{-1}
                    \bigg(
                        \frac{
                            \mathbf{r}_{s}\cdot
                            \mathbf{r}_{E}
                        }{
                            \norm{\mathbf{r}_{s}}
                            \norm{\mathbf{r}_{E}}
                        }
                    \bigg)
                    -\frac{1}{2}\cos^{-1}
                        \bigg(
                            \frac{
                                \mathbf{r}_{E}\cdot
                                \hat{\mathbf{n}}_{out}
                            }{\norm{\mathbf{r}_{E}}}
                        \bigg)
                        -\frac{1}{2}\cos^{-1}
                            \bigg(
                                \frac{
                                    (-\mathbf{r}_{s})\cdot
                                    \hat{\mathbf{n}}_{in}
                                }{\norm{\mathbf{r}_{s}}}
                            \bigg)\\
                \Rightarrow\phi
                &=\frac{1}{2}\cos^{-1}
                    \bigg(
                        \frac{
                            \mathbf{r}_{s}\cdot
                            \mathbf{r}_{E}
                        }{
                            \norm{\mathbf{r}_{s}}
                            \norm{\mathbf{r}_{E}}
                        }
                    \bigg)
                 +\frac{1}{2}\cos^{-1}
                     \bigg(
                         \frac{
                             \mathbf{r}_{E}\cdot
                             \hat{\mathbf{n}}_{out}
                         }{
                             \norm{\mathbf{r}_{E}}
                         }
                     \bigg)
                 -\frac{1}{2}\cos^{-1}
                     \bigg(
                         \frac{
                             (-\mathbf{r}_{s})\cdot
                             \hat{\mathbf{n}}_{in}
                         }{
                             \norm{\mathbf{r}_{s}}
                         }
                     \bigg)
            \end{align*}
        \end{proof}
        \begin{theorem}
            \label{%
                theorem:impact_parameter_p_%
                closed_form_solution
            }
            $p=\norm{\mathbf{p}_{in}}%
              =\norm{\mathbf{r}_{S}}%
               \cos(\phi-\frac{\alpha}{2})$
        \end{theorem}
        \begin{proof}
            As $P$ is the orthogonal projection of $O$
            onto $\overline{CA}$,
            $\angle{OPC}=\frac{\pi}{2}$. But then:
            \begin{equation*}
                |\overline{OP}|
                =|\overline{OC}|\sin(\angle{OCP})
            \end{equation*}
            But $|\overline{OP}|=\norm{\mathbf{p}_{in}}$,
            $|\overline{OC}|=\norm{\mathbf{r}_{S}}$,
            and $\angle{OCP}=\theta$. Therefore:
            \begin{equation*}
                \norm{\mathbf{p}_{in}}
                =\norm{\mathbf{r}_{S}}\sin(\theta)
            \end{equation*}
            But $\theta=\frac{\pi}{2}+\frac{\alpha}{2}-\phi$,
            and $\sin(\frac{\pi}{2}+x)=\cos(x)$. Therefore:
            \begin{equation*}
                \norm{\mathbf{p}_{in}}
                =\norm{\mathbf{r}_{S}}\cos
                    \big(\frac{\alpha}{2}-\phi\big)
            \end{equation*}
        \end{proof}
        \begin{theorem}
            $\norm{\mathbf{p}_{in}}%
             =|\overline{OA}|\sin(\beta)$
        \end{theorem}
        \begin{proof}
            For $\overline{OP}$ is perpendicular to
            $\overline{CA}$, and therefore $\Delta OPA$
            is a right-angled triangle, and $\overline{OA}$
            is the hypotenuse. Moreoever
            $\angle{PAO}=\beta$. But then:
            \begin{align*}
                |\overline{OP}|
                &=|\overline{OA}|\sin(\angle PAO)\\
                \Rightarrow|OP|
                &=|\overline{OA}|\sin(\beta)
            \end{align*}
            But $\norm{\mathbf{p}_{in}}=|\overline{OP}|$, and
            thus $\norm{\mathbf{p}_{in}}=|OA|\sin(\beta)$
        \end{proof}
        \begin{theorem}
            \label{theorem:p_out_equals_p_in}
            $\norm{\mathbf{p}_{in}}=\norm{\mathbf{p}_{out}}$
        \end{theorem}
        \begin{proof}
            For $\angle OAE=\angle{OAC}=\beta$, and thus:
            \begin{equation*}
                \norm{\mathbf{p}}_{out}
                =|\overline{OA}|\sin(\angle OAE)
                =|\overline{OA}|\sin(\beta)
                =\norm{\mathbf{p}}_{in}
            \end{equation*}
        \end{proof}
    \section{Ring Geometry}
        \begin{theorem}
            \label{theorem:ring_occ_geom_x_y_z_orthonormal_basis}
            If $\hat{\mathbf{u}}$ and $\hat{\mathbf{z}}$ are unit
            vectors and
            $\hat{\mathbf{u}}\times%
             \hat{\mathbf{z}}\ne\mathbf{0}$,
            then:
            \begin{equation}
                \label{eqn:Cassini_Math_Saturn_Basis}
                \{\hat{\mathbf{x}},\hat{\mathbf{y}},
                \hat{\mathbf{z}}\}
                =\Big\{\big(
                    \frac{\hat{\mathbf{u}}\times\hat{\mathbf{z}}}
                         {\norm{\hat{\mathbf{u}}\times
                          \hat{\mathbf{z}}}}
                \big)\times\hat{\mathbf{z}},
                \frac{\hat{\mathbf{u}}\times\hat{\mathbf{z}}}
                     {\norm{\hat{\mathbf{u}}\times
                      \hat{\mathbf{z}}}},
                \hat{\mathbf{z}}\Big\}
            \end{equation}
            is an orthonormal basis of $\mathbb{R}^{3}$.
        \end{theorem}
        \begin{proof}
            Since $\hat{\mathbf{u}}\times\hat{\mathbf{z}}$ is a
            non-zero vector,
            $\norm{\mathbf{u}\times\mathbf{z}}\ne{0}$. Thus, let
            $\hat{\mathbf{y}}%
             =\frac{\hat{\mathbf{u}}\times\hat{\mathbf{z}}}%
                   {\norm{\hat{\mathbf{u}}\times\hat{\mathbf{z}}}}$
            and let
            $\hat{\mathbf{x}}%
             =\hat{\mathbf{y}}\times\hat{\mathbf{z}}$.
            Then $\hat{\mathbf{y}}\cdot\hat{\mathbf{z}}=0$,
            $\hat{\mathbf{y}}\cdot\hat{\mathbf{x}}=0$,
            and $\hat{\mathbf{x}}\cdot\hat{\mathbf{z}}=0$.
            Both $\hat{\mathbf{z}}$ and $\hat{\mathbf{y}}$ are unit
            vectors by definition, and $\hat{\mathbf{x}}$ is the
            cross product of two orthogonal unit vectors, and is
            therefore itself a unit vector. But then
            $\{\hat{\mathbf{x}},\hat{\mathbf{y}},\hat{\mathbf{z}}\}$
            is a set of 3 mutually orthogonal unit vectors.
            By the Vector Space Dimension Theorem,
            $\{\hat{\mathbf{x}},%
               \hat{\mathbf{y}},%
               \hat{\mathbf{z}}\}$
            is an orthonormal basis of $\mathbb{R}^3$.
        \end{proof}
        We define our Saturnian Coordinate System to be the
        Cartesian Coordinate System where $\mathbf{u}$
        is the vector from Earth to the Spacecraft,
        $\hat{\mathbf{z}}$ is Saturn's Pole vector, and let
        $\hat{\mathbf{x}}$ and $\hat{\mathbf{y}}$
        be as defined in
        Eqn.~\ref{eqn:Cassini_Math_Saturn_Basis}.
        The origin is taken to be Saturn's Center.
        The ring plane of Saturn is the plane perpendicular
        to $\hat{\mathbf{z}}$ which contains the origin.
        \begin{theorem}
            Saturn's ring plane is the $xy$ plane.
        \end{theorem}
        \begin{proof}
            This is a restatement of the fact that
            $\{\hat{\mathbf{x}},%
               \hat{\mathbf{y}},%
               \hat{\mathbf{z}}\}$
            is an orthonormal system
            (Thm.~\ref{%
                theorem:ring_occ_geom_%
                x_y_z_orthonormal_basis%
            })
            and from the definition of Saturn's ring plane.
        \end{proof}
        \begin{theorem}
            \label{thm:Cassini_Math_u_parallel_xy}
            The Earth-Spacecraft line, $\mathbf{u}$,
            lies parallel to the $xz$ plane.
        \end{theorem}
        \begin{proof}
            It suffices to show that $\hat{\mathbf{u}}$
            is orthogonal to $\hat{\mathbf{y}}$.
            But:
            \begin{equation}
                \hat{\mathbf{u}}\cdot\hat{\mathbf{y}}
                =\hat{\mathbf{u}}\cdot
                \frac{\hat{\mathbf{u}}\times \hat{\mathbf{z}}}
                     {\norm{\hat{\mathbf{u}}
                      \times \hat{\mathbf{z}}}}
            \end{equation}
            And for any two vectors
            $\mathbf{a}$ and $\mathbf{b}$,
            $\mathbf{a}\cdot(\mathbf{a}\times\mathbf{b})%
             =\mathbf{0}$
            and therefore $\hat{\mathbf{u}}$ is orthogonal
            to $\hat{\mathbf{y}}$. Thus
            $\hat{\mathbf{u}}$ is parallel to the $xz$ plane.
        \end{proof}
        \begin{theorem}
            \label{thm:Cassini_Math_Earth_Line_Parallel_xz}
            In the Saturn Reference frame,
            Earth lies on the $xz$ plane if and
            only if the line from
            Earth to Cassini lies in it.
        \end{theorem}
        \begin{proof}
            If $\hat{\mathbf{u}}$ lies in the $xz$ plane,
            then Earth must also lie in it from the
            definition of $\mathbf{u}$. And from
            Thm.~\ref{thm:Cassini_Math_Earth_Line_Parallel_xz}
            $\hat{\mathbf{u}}$ lies parallel
            to the $xz$ plane. Thus, if Earth lies
            in the $xz$ plane, so must the line from
            Earth to Cassini.
        \end{proof}
        \begin{theorem}
            If $\hat{\mathbf{z}}$ and $\hat{\mathbf{u}}$
            are defined by:
            \begin{subequations}
                \begin{align}
                    \label{eqn:Cassini_Math_Sat_Pole_Coord}
                    \hat{\mathbf{z}}
                    &=z_{1}\hat{\mathbf{x}}_{E}+
                    z_{2}\hat{\mathbf{y}}_{E}+
                    z_3\hat{\mathbf{z}}_{E}\\
                    \label{eqn:Cassini_Math_RIP_Coord}
                    \hat{\mathbf{u}}
                    &=u_{E_{x}}\hat{\mathbf{x}}_{E}+
                    u_{E_{y}}\hat{\mathbf{y}}_{E}+
                    u_{E_{z}}\hat{\mathbf{z}}_{E}
                \end{align}
                then:
                \begin{equation}
                    \hat{\mathbf{y}}
                    =y_{1}\hat{\mathbf{x}}_{E}+
                     y_{2}\hat{\mathbf{y}}_{E}+
                     y_{3}\hat{\mathbf{z}}_{E}
                \end{equation}
                Where:
                \begin{align}
                    y_1
                    &=\frac{z_2u_{E_{z}}-z_{3}u_{E_{y}}}
                           {\sqrt{(z_2u_{E_{z}}-z_3u_{E_{y}})^2+
                            (z_3u_{E_{x}}-z_1u_{E_{z}})^2+
                            (z_1u_{E_{y}}-z_2u_{E_{x}})^2}}\\
                    y_{2}&=
                        \frac{z_3u_{E_{x}}- z_{1}u_{E_{z}}}
                             {\sqrt{(z_2u_{E_{z}}-z_3u_{E_{y}})^2+
                              (z_3u_{E_{x}}-z_1u_{E_{z}})^2+
                              (z_1u_{E_{y}}-z_2u_{E_{x}})^2}}\\
                    y_{3}&=
                        \frac{z_1u_{E_{y}}-z_2u_{E_{x}}}
                             {\sqrt{(z_2u_{E_{z}}-z_3u_{E_{y}})^2+
                              (z_3u_{E_{x}}-z_1u_{E_{z}})^2+
                              (z_1u_{E_{y}}-z_2u_{E_{x}})^2}}
                \end{align}
            \end{subequations}
        \end{theorem}
        \begin{proof}
            From the definition given in
            Thm.~\ref{theorem:ring_occ_geom_%
                      x_y_z_orthonormal_basis},
            $\hat{\mathbf{y}}$ is defined as
            $\frac{\hat{\mathbf{z}}\times\mathbf{u}_{0}}%
                  {\norm{\hat{\mathbf{z}}\times\mathbf{u}_{0}}}$.
            This equation is the
            cross-product divided by the norm.
        \end{proof}
        \begin{theorem}
            If $\hat{\mathbf{z}}$ and
            $\mathbf{u}_{0}$ are as defined in
            Eqn.~\ref{eqn:Cassini_Math_Sat_Pole_Coord}
            and \ref{eqn:Cassini_Math_RIP_Coord}, then:
            \begin{subequations}
                \begin{equation}
                    \hat{\mathbf{x}}=
                        x_{1}\hat{\mathbf{x}}_{E}+
                        x_{2}\hat{\mathbf{y}}_{E}+
                        x_{3}\hat{\mathbf{z}}_{E}
                \end{equation}
                Where:
                \begin{align}
                    x_1
                    &=\frac{z_{3}(z_{3}u_{E_{x}}-z_{1}u_{E_{z}})-
                            z_{2}(z_{1}u_{E_{y}}-z_{2}u_{E_{x}})}
                           {\sqrt{(z_{2}u_{E_{z}}-z_{3}u_{E_{y}})^{2}+
                            (z_{3}u_{E_{x}}-z_{1}u_{E_{z}})^{2}+
                            (z_{1}u_{E_{y}}-z_{2}u_{E_{x}})^{2}}}\\
                    x_2
                    &=\frac{z_{1}(z_{1}u_{E_{y}}-
                            z_{2}u_{E_{x}})-z_{3}(z_{2}u_{E_{z}}-
                            z_{3}u_{E_{y}})}
                           {\sqrt{(z_{2}u_{E_{z}}-z_{3}u_{E_{y}})^{2}+
                            (z_{3}u_{E_{x}}-z_{1}u_{E_{z}})^{2}+
                            (z_{1}u_{E_{y}}-z_{2}u_{E_{x}})^{2}}}\\
                    x_3
                    &=\frac{z_{2}(z_{2}u_{E_{z}}-
                            z_{3}u_{E_{y}})-z_{1}(z_{3}u_{E_{x}}-
                            z_{1}u_{E_{z}})}
                           {\sqrt{(z_{2}u_{E_{z}}-z_{3}u_{E_{y}})^{2}+
                            (z_{3}u_{E_{x}}-z_{1}u_{E_{z}})^{2}+
                            (z_{1}u_{E_{y}}-z_{2}u_{E_{x}})^{2}}}
                \end{align}
            \end{subequations}
            \end{theorem}
        \begin{proof}
            $\hat{\mathbf{x}}$ is defined as
            $\hat{\mathbf{y}}\times\hat{\mathbf{z}}$.
            This equation is merely that product.
        \end{proof}
        Thus if we have $\hat{\mathbf{u}}$ and
        $\hat{\mathbf{z}}$ in an Earth based system,
        we can easily compute the geometry in our
        Saturnian coordinate system. At the very least,
        a computer can easily compute this.
        \begin{theorem}
            If $(S_{x},S_{y},S_{z})$ is location of the
            center of Saturn with respect to the
            center of the Earth and $(x_{E},y_{E},z_{E})$
            is a point in $\mathbb{R}^{3}$ with respect
            to the center of the Earth, then the
            change of coordinates to the
            Saturn-based system is:
            \begin{equation*}
                    \begin{pmatrix}
                        x\\
                        y\\
                        z
                    \end{pmatrix}
                    =
                    \begin{pmatrix}
                        x_{1}&x_{2}&x_{3}\\
                        y_{1}&y_{2}&y_{3}\\
                        z_{1}&z_{2}&z_{3}
                    \end{pmatrix}
                    \begin{pmatrix}
                        x_{E}-S_{x}\\
                        y_{E}-S_{y}\\
                        z_{E}-S_{z}
                    \end{pmatrix}
                \end{equation*}
        \end{theorem}
        \begin{proof}
            The point
            $(x_{E}-S_{x},y_{E}-S_{y},z_{E}-S_{z})$
            translates the point $(x_{E},y_{E},z_{E})$
            to the center of Saturn.
            The rotation matrix then aligns the
            Earth-based coordinates to the
            Saturn-based coordinates.
        \end{proof}
    \section{Derivations of the Fresnel Kernel}
            Let $\hat{\mathbf{u}}$ be the unit
            vector pointing from Earth to the spacecraft.
            Let $\hat{\mathbf{z}}$ be the pole direction
            Saturn. To make the arguments easier,
            we assume the line from Earth to Saturn
            and the line from Earth to Voyager are
            parallel. That is, we assume that
            Saturn is infinitely far away.
            Define the following:
            \par
            \begin{equation}
                \label{eqn:Cassini_Math_Def_B}
                B=
                \sin^{-1}(\hat{\mathbf{z}}\cdot\hat{\mathbf{u}})
            \end{equation}
            \begin{subequations}
                \begin{minipage}{0.49\textwidth}
                    \begin{equation}
                        \hat{\mathbf{y}}=
                        \frac{\hat{\mathbf{u}}\times
                              \hat{\mathbf{z}}}
                             {\norm{\hat{\mathbf{u}}\times
                              \hat{\mathbf{z}}}}
                    \end{equation}
                \end{minipage}
                \hfill
                \begin{minipage}{0.49\textwidth}
                    \begin{equation}
                        \hat{\mathbf{x}}
                        =\hat{\mathbf{y}}\times
                        \hat{\mathbf{z}}
                    \end{equation}
                \end{minipage}
            \end{subequations}
            \par\hfill\par
            We take the origin as Saturn's center. From
            Thm.~\ref{thm:Cassini_Math_u_parallel_xy},
            $\hat{\mathbf{u}}$ lies parallel to the
            $xz$ plane, and thus there are numbers
            $a_{1},a_{2}$ such that:
            \begin{equation}
                \hat{\mathbf{u}}=a_{1}\hat{\mathbf{x}}+
                a_{2}\hat{\mathbf{z}}
            \end{equation}
            We can compute for $a_{1}$ and $a_{2}$ by using
            the definition of $B$ in
            Eqn.~\ref{eqn:Cassini_Math_Def_B}.
            \begin{equation}
                \hat{\mathbf{u}}
                =\cos(B)\hat{\mathbf{x}}+
                \sin(B)\hat{\mathbf{z}}
            \end{equation}
            Let $\boldsymbol{\uprho}_{0}$ be the vector pointing
            from Saturn to the ring intercept point,
            and let $\boldsymbol{\uprho}$ be a vector in
            the ring plane. Let $\phi_{0}$ and
            $\phi$ be the angles made with
            $\boldsymbol{\uprho}_{0}$ and $\boldsymbol{\uprho}$
            to the $x$ axis, respectively. Then:
            \par
            \vspace{-1ex}
            \begin{subequations}
                \begin{minipage}{0.49\textwidth}
                    \begin{equation}
                        \boldsymbol{\uprho}_{0}
                        =\rho_{0}\big(\cos(\phi_0)
                        \hat{\mathbf{x}}+
                        \sin(\phi_{0})\hat{\mathbf{y}}\big)
                    \end{equation}
                \end{minipage}
                \hfill
                \begin{minipage}{0.49\textwidth}
                    \begin{equation}
                        \boldsymbol{\uprho}
                        =\rho\big(\cos(\phi)
                        \hat{\mathbf{x}}+
                        \sin(\phi)\hat{\mathbf{y}}\big)
                    \end{equation}
                \end{minipage}
            \end{subequations}
            \par\hfill\par\hfill\par
            \vspace{-1.5ex}
            Let $\mathbf{R}_{c}$ be the vector pointing
            from Saturn to Voyager. Let $D$ be the
            distance from the ring intercept point
            to Voyager.
            We thus have the following:
            \begin{subequations}
                \begin{align}
                    \mathbf{R}_{c}&=
                    \boldsymbol{\uprho}_{0}+
                    D\hat{\mathbf{u}}\\
                    &=\big(
                    \rho_{0}\cos(\phi_0)+D\cos(B)
                    \big)\hat{\mathbf{x}}+
                    \rho_{0}\sin(\phi_{0})\hat{\mathbf{y}}+
                    D\sin(B)\hat{\mathbf{z}}
                \end{align}
            \end{subequations}
            We wish to compute
            $\hat{\mathbf{u}}\cdot%
             \boldsymbol{\uprho}+%
             \norm{\mathbf{R}_{c}-\boldsymbol{\uprho}}$.
            We have:
            \begin{subequations}
                \begin{align}
                    \hat{\mathbf{u}}\cdot\boldsymbol{\uprho}
                    &=\big(\cos(B)\hat{\mathbf{x}}+
                           \sin(B)\hat{\mathbf{z}}\big)
                        \cdot\big(\rho(\cos(\phi)\hat{\mathbf{x}}+
                                  \sin(\phi)\hat{\mathbf{y}})\big)\\
                    &=\rho\cos(B)\cos(\phi)
                \end{align}
            \end{subequations}
            And also:
            \begin{subequations}
                \begin{align}
                    \norm{\mathbf{R}_{c}-\boldsymbol{\uprho}}
                    &=\sqrt{(\mathbf{R}_{c}-
                    \boldsymbol{\uprho})\cdot(\mathbf{R}_{c}-
                    \boldsymbol{\uprho})}\\
                    &=\sqrt{\norm{\mathbf{R}_{c}}^2+
                    \norm{\boldsymbol{\uprho}}^2-
                    2\mathbf{R}_{c}\cdot\boldsymbol{\uprho}}
                \end{align}
            \end{subequations}
            But, since $\hat{\mathbf{u}}$ is a unit vector and
            $\boldsymbol{\rho}_{0}\cdot\boldsymbol{\rho}_{0}%
             =\rho_{0}^{2}$,
            we have:
            \begin{subequations}
                \begin{align}
                    \norm{\mathbf{R}_{c}}^{2}
                    &=\rho_{0}^2+D^{2}+2\rho_{0}D
                    \boldsymbol{\uprho}_{0}\cdot\hat{\mathbf{u}}\\
                    &=\rho_{0}^2+D^{2}+
                    2D\rho_{0}\cos(\phi_{0})\cos(B)
                \end{align}
            \end{subequations}
            Furthering the computation we have:
            \begin{subequations}
                \begin{align}
                    \mathbf{R}_{c}\cdot\boldsymbol{\uprho}
                    &=\rho\cos(\phi)
                    \big(\rho_{0}\cos(\phi_{0})+D\cos(B)\big)+
                    \rho\rho_{0}\sin(\phi)\sin(\phi_{0})\\
                    &=\rho\rho_{0}
                    \big(\cos(\phi)\cos(\phi_{0})+
                         \sin(\phi)\sin(\phi_{0})\big)+
                    \rho{D}\cos(\phi)\cos(B)\\
                    &=\rho\rho_{0}\cos(\phi-\phi_{0})+
                    \rho{D}\cos(\phi)\cos(B)
                \end{align}
            \end{subequations}
            So we have:
            \begin{equation}
                \begin{split}
                    \norm{\mathbf{R}_{c}-\boldsymbol{\uprho}}^{2}
                    =\rho^{2}+\rho_{0}^{2}+D^{2}&-
                    2\rho\rho_{0}\cos(\phi-\phi_{0})
                    \\&+2D\cos(B)\big(\rho_{0}\cos(\phi_0)-
                    \rho\cos(\phi)\big)
                \end{split}
            \end{equation}
            Now the definition of $\hat{T}$ is:
            \begin{equation}
                \hat{T}=\frac{E_{c}}{E_{0}}
                e^{-ik\hat{\mathbf{u}}\cdot\mathbf{R}_{c}}
            \end{equation}
            So we define $\psi$ as:
            \begin{equation}
                \psi=
                k\big(\norm{\mathbf{R}_{c}-\rho}^{2}+
                      \hat{\mathbf{u}}\cdot\boldsymbol{\rho}-
                      \hat{\mathbf{u}}\cdot\mathbf{R}_{c}\big)
            \end{equation}
            Trudging along, we have:
            \begin{subequations}
                \begin{align}
                    \hat{\mathbf{u}}\cdot\mathbf{R}_{c}
                    &=\rho_{0}\cos(\phi_0)\cos(B)+
                    D\cos^{2}(B)+D\sin^2(B)\\
                    &=\rho_{0}\cos(\phi_{0})\cos(B)+D    
                \end{align}
            \end{subequations}
            Let's define the following:
            \begin{align}
                \xi&=\frac{\cos(B)\big(\rho\cos(\phi)-
                           \rho_{0}\cos(\phi_{0})\big)}
                          {D}\\
                \eta&=\frac{\rho_{0}^2+\rho^2-
                            2\rho\rho_{0}\cos(\phi-\phi_{0})}
                           {D^{2}}
            \end{align}
            Please note that $\xi$ differs in sign from
            the definition found in MTR86. This is done
            intentionally in order for problem to lend
            itself more naturally to the use of
            Legendre polynomials.
            Using this, we finally obtain:
            \begin{equation}
                \psi=kD\big[\sqrt{1+\eta-2\xi}-(1-\xi)\big]
            \end{equation}
            An important configuration to consider is when
            $\phi=\phi_{0}$. Evaluating $\psi$, we obtain:
            \begin{equation}
                \begin{split}
                    \psi_{\phi=\phi_{0}}
                    =kD\Big[&\cos(\phi_{0})\cos(B)
                    \big(\frac{\rho-\rho_{0}}{D}\big)-1\\
                    &+\sqrt{1+
                    \big(\frac{\rho-\rho_{0}}{D}\big)^{2}
                    -2\cos(\phi_{0})\cos(B)
                    \big(\frac{\rho-\rho_{0}}{D}\big)}\Big]
                \end{split}
            \end{equation}
            Define the following:
            \par\hfill\par
            \vspace{-1ex}
            \begin{subequations}
                \begin{minipage}{0.49\textwidth}
                    \begin{equation}
                        x=\frac{\rho-\rho_{0}}{D}
                    \end{equation}
                \end{minipage}
                \hfill
                \begin{minipage}{0.49\textwidth}
                    \begin{equation}
                        \alpha=\cos(\phi_{0})\cos(B)
                    \end{equation}
                \end{minipage}
            \end{subequations}
            Then we may rewrite $\psi_{\phi=\phi_{0}}$ as:
            \begin{equation}
                \psi_{\phi=\phi_{0}}=
                kD\Big[\alpha{x}-1+\sqrt{1+x^{2}-2x}\Big]
            \end{equation}
            This is where the Legendre polynomials
            come into play. Letting $P_{n}(\alpha)$
            denote the $n^{th}$ Legendre polynomial,
            the generating function is:
            \begin{equation}
                \label{eqn:CASSINI:MATH:Legendre_Gen_Func}
                \sum_{n=0}^{\infty}P_{n}(\alpha)x^{n}
                =\frac{1}{\sqrt{1+x^{2}-2\alpha{x}}}
            \end{equation}
            We don't quite have this, but we can
            produce a differential equation that
            will lead us to this. First note
            the following:
            \begin{equation}
                \frac{\diff}{\diff{x}}
                \Big(\sqrt{1+x^{2}-2\alpha{x}}\Big)
                =\frac{x-\alpha}{\sqrt{1+x^{2}-2\alpha{x}}}
            \end{equation}
            But from
            Eqn.~\ref{eqn:CASSINI:MATH:Legendre_Gen_Func}, we
            have:
            \begin{equation}
                \frac{\diff}{\diff{x}}
                \Big(\sqrt{1+x^{2}-2\alpha{x}}\Big)
                =(x-\alpha)
                \sum_{n=0}^{\infty}P_{n}(\alpha)x^{n}
            \end{equation}
            Integrating across, we then obtain:
            \begin{equation}
                \sqrt{1+x^{2}-2\alpha{x}}
                =1+\sum_{k=0}^{\infty}P_{k}(\alpha)
                \frac{x^{k+2}}{k+2}
                -\alpha\sum_{k=0}^{\infty}P_{k}(\alpha)
                \frac{x^{k+1}}{k+1}
            \end{equation}
            And so finally:
            \begin{equation}
                \sqrt{1+x^{2}-2\alpha{x}}+\alpha{x}-1
                =\sum_{k=0}^{\infty}
                \Big(P_{k}(\alpha)-
                     \alpha{P_{k+1}}(\alpha)\Big)
                \frac{x^{k+2}}{k+2}
            \end{equation}
            We can use this to evaluate and
            approximate $\psi$.
            Define the following sequence:
            \begin{equation}
                b_{k}=
                \frac{P_{k}(\alpha)-\alpha{P_{k+1}}(\alpha)}
                     {k+2}
            \end{equation}
            Then $\psi_{\phi=\phi_{0}}$ may be expressed
            as follows:
            \begin{equation}
                \psi_{\phi=\phi_{0}}=
                kD\sum_{k=0}^{\infty}b_{k}x^{k+2}
            \end{equation}
\end{document}