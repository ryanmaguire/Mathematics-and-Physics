\documentclass[crop=false,class=book,oneside]{standalone}
%----------------------------Preamble-------------------------------%
\input{../../preamble.tex}
%--------------------------Main Document----------------------------%
\begin{document}
    \ifx\ifplanetdiff\undefined
        \newif\iffunct
        \title{Diffraction Theory}
        \author{Ryan Maguire}
        \date{\vspace{-5ex}}
        \maketitle
        \tableofcontents
        \clearpage
        \chapter*{Diffraction Theory}
        \addcontentsline{toc}{chapter}{Diffraction Theory}
        \markboth{}{DIFFRACTION THEORY}
        \setcounter{chapter}{4}
    \else
        \chapter{Diffraction Theory}
    \fi
    \section{Fresnel-Fraunhofer Theory}
    \section{Fresnel Inversion}
    \section{Problems with Fresnel Inversion}
    \section{Diffraction Theory}
        \subsection{Diffraction Through a Square Well}
            \label{Subsec:Cassini_Math_Diffraction_%
                   Through_a_Square_well}
            We wish to solve for $\hat{T}(\rho_{0})$. We have that:
            \begin{equation*}
                \hat{T}(\rho_{0})
                =\frac{1-i}{2F}
                    \int_{-\infty}^{\infty}T(\rho)
                    \exp\Big(i\frac{\pi}{2}
                        \big(\frac{\rho-\rho_{0}}{F}\big)^{2}\Big)
                    \diff{\rho}
            \end{equation*}
            For the square well of height $M$
            starting at $a$ and ending at $b$:
            \begin{equation*}
                T(\rho)=
                \begin{cases}
                    0,&\rho<a\\
                    M,&a\leq\rho\leq{b}\\
                    0,&b<\rho
                \end{cases}
            \end{equation*}
            Let $H_{M}(\rho_0,F;a,b)$ denote the solution.
            So, we have:
            \begin{equation*}
                H_{M}(\rho_0,F;a,b)
                =\frac{1-i}{2F}
                    \int_{a}^{b}M
                    \exp\Big(i\frac{\pi}{2}
                        \big(\frac{\rho-\rho_{0}}{F}\big)^{2}\Big)
                    \diff{\rho}
                =\frac{M}{F}\frac{1-i}{2}
                    \int_{a}^{b}
                    \exp\Big(i\frac{\pi}{2}
                        \big(\frac{\rho-\rho_{0}}{F}\big)^{2}\Big)
                    \diff{\rho}
            \end{equation*}
            Now from Euler's formula,
            $\exp(i\theta)=\cos(\theta)+i\sin(\theta).$ Letting
            $\theta=\frac{\pi}{2}\big(\frac{\rho-\rho_0}{F}\big)^2$,
            we have:
            \begin{equation*}
                \exp\Big(
                    i\frac{\pi}{2}\big(\frac{\rho-\rho_{0}}{F}\big)^{2}
                    \Big)
                =\cos\Big(
                    \frac{\pi}{2}\big(\frac{\rho-\rho_{0}}{F}\big)^{2}
                \Big)+
                i\sin\Big(
                    \frac{\pi}{2}\big(\frac{\rho-\rho_{0}}{F}\big)^{2}
                \Big)
            \end{equation*}
            The definition of the Fresnel Cosine Integral and
            Sine Integrals $\big(C(x),S(x)\big)$ are:
            \begin{align*}
                C(x)
                &=\int_{0}^{x}\cos
                    \Big(\frac{\pi}{2}\tau^{2}\Big)\diff{\tau}
                &
                S(x)
                &=\int_{0}^{x}\sin
                    \Big(\frac{\pi}{2}\tau^{2}\Big)\diff{\tau}
            \end{align*}
            So:
            \begin{align*}
            \int_{a}^{b}\sin\Big(\frac{\pi}{2}x^{2}\Big)\diff{x}
            &=\int_{0}^{b}\sin\Big(\frac{\pi}{2}x^{2}\Big)\diff{x}-
            \int_{0}^{a}\sin\Big(\frac{\pi}{2}x^{2}\Big)\diff{x}\\
            &=S(b)-S(a)\\
            \int_{a}^{b}\cos\Big(\frac{\pi}{2}x^{2}\Big)\diff{x}
            &=\int_{0}^{b}\cos\Big(\frac{\pi}{2}x^{2}\Big)\diff{x}-\int_{0}^{a}\cos\Big(\frac{\pi}{2}x^{2}\Big)\diff{x}\\
            &=C(b)-C(a)
            \end{align*}
            We can now compute
            $H_{M}(\rho_0,F;a,b)$.
            Let $x=\frac{\rho-\rho_0}{F}$. Then $dx = \frac{d\rho}{F}$.
            We have:
            \begin{align*}
                H_{M}(\rho_0,F;a,b)
                &=\frac{M}{F}\frac{1-i}{2}
                    \int_{a}^{b}
                    \exp\Big(i\frac{\pi}{2}
                    \big(\frac{\rho-\rho_0}{F}\big)^{2}\Big)
                \diff{\rho}\\
                &=\frac{M}{F}\frac{1-i}{2}
                    \bigg[\int_{a}^{b}
                    \cos\Big(\frac{\pi}{2}
                    \big(\frac{\rho-\rho_0}{F}\big)^{2}\Big)
                \diff{\rho}+
                i\int_{a}^{b}
                    \sin\Big(\frac{\pi}{2}
                    \big(\frac{\rho-\rho_0}{F}\big)^{2}\Big)
                    \diff{\rho}\bigg]\\
                &=M\frac{1-i}{2}\bigg[
                    \int_{\frac{a-\rho_0}{F}}^{\frac{b-\rho_0}{F}}
                    \cos\Big(\frac{\pi}{2}x^{2}\Big)\diff{x}+
                i\int_{\frac{a-\rho_0}{F}}^{\frac{b-\rho_0}{F}}
                    \sin\Big(\frac{\pi}{2}x^{2}\Big)\diff{x}
                \bigg]\\
                &=M\frac{1-i}{2}
                    \bigg[\bigg(C\Big(\frac{b-\rho_{0}}{F}\Big)-
                        C\Big(\frac{a-\rho_0}{F}\Big)\bigg)
                    +i\bigg(S\Big(\frac{b-\rho_0}{F}\Big)-
                        S\Big(\frac{a-\rho_0}{F}\Big)\bigg)\bigg]
            \end{align*}
        \subsection{Diffraction Through an Inverted Square Well}
            This time we have:
            \begin{equation*}
                T(\rho)=
                \begin{cases}
                    M,&\rho<a\\
                    0,&a\leq\rho\leq{b}\\
                    M,&b<\rho
                \end{cases}    
            \end{equation*}
            So $T(\rho) = M - T_{Sq}(\rho)$,
            where $T_{Sq}(\rho)$ is the impulse from the standard
            square well (See
            \ref{Subsec:Cassini_Math_Diffraction_Through_a_Square_well}).
            So we wish to solve:
            \begin{equation*}
                \hat{T}(\rho_{0})=
                \frac{1-i}{2F}\int_{-\infty}^{\infty}
                \big(M-T_{Sq}(\rho)\big)
                \exp(i\frac{\pi}{2}\Big(\frac{\rho-\rho_{0}}{F}\Big)^{2})
                \diff{\rho}
            \end{equation*}
                Simplifying, we have:
                \begin{align*}
                    \hat{T}(\rho_{0})
                    &=\frac{1-i}{2F}\int_{-\infty}^{\infty}
                    \big(M-T(\rho)\big)
                    \exp\Big(i\frac{\pi}{2}
                        \big(\frac{\rho-\rho_0}{F}\big)^{2}\Big)
                    \diff{\rho}\\
                    &=\frac{M}{F}\frac{1-i}{2}
                    \bigg(\int_{-\infty}^{\infty}
                    \exp\Big(i\frac{\pi}{2}
                        \big(\frac{\rho-\rho_0}{F}\big)^2\Big)
                    \diff{\rho}-
                    \int_{a}^{b}
                    \exp\Big(i\frac{\pi}{2}
                        \big(\frac{\rho-\rho_0}{F}\big)^2\Big)
                    \diff{\rho}\Bigg)\\
                \end{align*}
                But from the previous derivation:
                \begin{equation*}
                    \int_{a}^{b}
                    \exp\Big(i\frac{\pi}{2}
                        \big(\frac{\rho-\rho_0}{F}\big)^{2}\Big)
                    \diff{\rho}
                    =F\bigg(C\Big(\frac{b-\rho_0}{F}\Big)-
                    C\Big(\frac{a-\rho_0}{F}\Big)\bigg)+
                    i\bigg(S\Big(\frac{b-\rho_0}{F}\Big)-
                    S\Big(\frac{a-\rho_0}{F}\Big)\bigg)
                \end{equation*}
                And:
                \begin{equation*}
                    \int_{-\infty}^{\infty}
                    \exp\Big(i\frac{\pi}{2}
                        \big(\frac{\rho-\rho_0}{F}\big)^{2}\Big)
                    \diff{\rho}
                    =\underset{a\rightarrow \infty}{\lim}
                    \int_{-a}^{a}
                    \exp\Big(i\frac{\pi}{2}
                        \big(\frac{\rho-\rho_0}{F}\big)^{2}\Big)
                    \diff{\rho}
                    =F(1+i)
                \end{equation*}
                Piecing this together, and using the notation from before,
                we have:
                \begin{equation*}
                \hat{T}(\rho_0)=M-H_{M}(\rho_0,F;a,b)
                \end{equation*}
        \subsection{Radial Shift from a Linear Phase Offset}
            \begin{theorem}
                If $\hat{T}_0(\rho_0)=\hat{T}(\rho_0)e^{i(a\rho+b)}$,
                and if $\hat{f}(\xi)=\mathcal{F}_{\xi}(\hat{T}(\rho_0))$,
                then $\mathcal{F}_{\xi}(\hat{T}_{0}(\rho_0))=e^{ib}\hat{f}(\frac{a}{2\pi}+\xi)$.
            \end{theorem}
            \begin{proof}
                Let $\hat{T}(\rho_0)$ be the complex amplitude,
                $\hat{T}=\norm{\hat{T}}e^{i\theta}$, where
                $\theta=\theta(\rho_0)$ is the phase. Let
                $\hat{f}(\xi)$ denote the Fourier Transform
                of $\hat{T}(\rho_0)$ onto $\xi$. If there is a
                linear offset in the phase $a\rho_0+b$, we have
                $\hat{T}_{0}=\hat{T}e^{i(a\rho+ib)}$. Taking the
                Fourier Transform of this, we have the following:
            \begin{align*}
                \mathcal{F}_{\xi}(\hat{T}_{0})
                &=\int_{-\infty}^{\infty}\hat{T}(\rho_0)
                e^{i(a\rho+b)}e^{i2\pi \rho_0 \xi}d\rho_0\\
            &=e^{ib} \int_{-\infty}^{\infty} \hat{T}(\rho_0)e^{i\rho_0(a+2\pi \xi)}d\rho_0
            \end{align*}
            
            Letting $\eta = \frac{a}{2\pi}+\xi$, we have:
            
            \begin{align*}
            \nonumber \mathcal{F}_{\xi} (\hat{T}_{0}) &= e^{ib}\int_{-\infty}^{\infty}\hat{T}(\rho_0)e^{i2\pi\rho_{0}\eta}d\rho_0 \\
            \nonumber &= e^{ib}\hat{f}(\eta)\\
            		 &= e^{ib}\hat{f}(\frac{a}{2\pi}+\xi)
            \end{align*}
            
            Thus, we have that:
            
            \begin{equation*}
            \mathcal{F}_{\xi} (\hat{T}_{0}) = e^{ib}\hat{f}(\frac{a}{2\pi}+\xi)
            \end{equation*}
            So we see that a linear offset in phase creates a horizontal shift in the Fourier transform.
            \end{proof}
            
            We want the affects on $T(\rho)$.
            
            \begin{theorem}
            If $\hat{T}_0(\rho_0) = \hat{T}(\rho_0)e^{i(a\rho+b)}$, $F\ne 0$, $T(\rho) = \int_{-\infty}^{\infty}\hat{T}(\rho_0)e^{i\frac{\pi}{2}\big(\frac{\rho-\rho_0}{F}\big)^2} d\rho_0$, and if $T_{0}(\rho) = \int_{-\infty}^{\infty}\hat{T}_{0}(\rho_0)e^{i\frac{\pi}{2}\big(\frac{\rho-\rho_0}{F}\big)^2} d\rho_0$, then $\norm{T_{0}(\rho)} = \norm{T(\rho - \frac{aF^2}{\pi})}$
            \end{theorem}
            \begin{proof}
            \begin{align*}
            T_0(\rho) &= \int_{-\infty}^{\infty} \hat{T}_{0}(\rho_0)e^{i\frac{\pi}{2}\big(\frac{\rho-\rho_0}{F}\big)^2}d\rho_0\\
            &=\int_{-\infty}^{\infty} \hat{T}(\rho_0)e^{i(a\rho_0+b)}e^{i\frac{\pi}{2}\big(\frac{\rho - \rho_0}{F}\big)^2}d\rho_0 \\
            	&= e^{ib}\int_{-\infty}^{\infty}\hat{T}(\rho_0)e^{i\frac{\pi}{2}\bigg[\big(\frac{\rho-\rho_0}{F}\big)^2 + \frac{2a}{\pi}\rho_0\bigg]}d\rho_0
            \end{align*}
            Expanding the terms in the exponential and simplifying, we have:
            \begin{align*}
                \big(\frac{\rho-\rho_0}{F}\big)^2 + \frac{2a}{\pi}\rho &= \frac{\rho_0^2 - 2\rho\rho_0 + \rho^2 + \frac{2aF^2}{\pi}\rho_0}{F^2}\\
                &= \frac{\rho_0^2 - 2\rho_0(\rho - \frac{aF^2}{\pi}) + \rho^2}{F^2}\\
                &= \frac{\big(\rho_0 - (\rho - \frac{aF^2}{\pi})\big)^2 - (\rho - \frac{aF^2}{\pi})^2 + \rho^2}{F^2}\\
                &= \frac{\big(\rho_0 - (\rho-\frac{aF^2}{\pi})\big)^2 +\frac{2aF^2}{\pi}\rho - \frac{a^2F^4}{\pi^2}}{F^2}\\
                &= \frac{\big(\rho_0 - (\rho-\frac{aF^2}{\pi})\big)^2}{F^2} + \frac{2a}{\pi}\rho - \frac{a^2F^2}{\pi^2}
            \end{align*}
            The integral is over $\rho_0$, so we may write:
            \begin{equation*}
            T_0(\rho) = e^{ib}e^{i\frac{\pi}{2}\big(\frac{2a}{\pi}\rho - \frac{a^2F^2}{\pi^2}\big)}\int_{-\infty}^{\infty} \hat{T}(\rho_0)e^{i\frac{\pi}{2}\big(\frac{\rho_0 - (\rho - \frac{aF^2}{\pi})}{F}\big)^2}d\rho_0
            \end{equation*}
            Let $u = \rho - \frac{aF^2}{\pi}$. Then we have:
            \begin{equation*}
            \int_{-\infty}^{\infty} \hat{T}(\rho_0)e^{i\frac{\pi}{2}\big(\frac{\rho_0 - u}{F}\big)^2}d\rho_0 = T(u)
            \end{equation*}
            Therefore:
            \begin{equation*}
            T_0(\rho) = e^{ib}e^{i\frac{\pi}{2}\big(\frac{2a}{\pi}\rho - \frac{a^2F^2}{\pi^2}\big)}T(\rho - \frac{aF^2}{\pi})
            \end{equation*}
            Computing reconstructed power takes the norm $\norm{T_{0}(\rho)}$, and $\norm{e^{ib}e^{i\frac{\pi}{2}\big(\frac{2a}{\pi}\rho - \frac{a^2F^2}{\pi^2}\big)}} = 1$, for all values of $a,F, \rho$ (This is from Euler's theorem). Thus:
            \begin{equation*}
                \norm{T_{0}(\rho)} = \norm{T\big(\rho - \frac{aF^2}{\pi}\big)}    
            \end{equation*}
            So a linear offset $a\rho_0+b$ in the phase creates a radial offset in the reconstructed power of $-\frac{aF^2}{\pi}$.
            \end{proof}
        \subsection{Some Notes on Fresnel Inversion}
            The main equation we wish to study is:
            \begin{equation*}
            \hat{T}(\rho_0) = \frac{1-i}{2F}\int_{-\infty}^{\infty} T(\rho)e^{i\psi(\rho_0,\phi_0,\rho,\phi_s)}d\rho
            \end{equation*}
            We wish to solve for $T(\rho)$. In general, this is not possible. Indeed, uniqueness is not always necessary. Let us suppose that $\psi = \sum_{n=0}^{\infty}a_n(\rho_0 - \rho)^n$. It is still not the case that we may solve this. What we wish to do is use the Convolution theorem, which states the following:
            \begin{theorem}
            If $f,g\in L^{1}(\mathbb{R})$, then $f*g = \mathcal{F}^{-1}\big(\mathcal{F}_{\xi}(f)\cdot \mathcal{F}_{\xi}(g)\big)$
            \end{theorem}
            The requirement that $f,g\in L^{1}(\mathbb{R})$ is necessary. Suppose we have $\int_{-\infty}^{\infty} e^{-\rho^2}e^{2\pi i(\rho_0 - \rho)}d\rho = T*e^{i2\pi \rho}$. $\mathcal{F}_{\rho_0}(e^{-\rho^2})\cdot \mathcal{F}_{\rho_0}(e^{2\pi i \rho}) = \sqrt{\pi}e^{-\pi^2 \rho_0^2}\int_{-\infty}^{\infty}e^{2\pi i(\rho-\rho_0)}d\rho$, and this integral on the right does not converge. We may speak in terms of distributions, or generalized functions (Most commonly, the delta function), but this makes numerical application difficult. Going back to our original problem, we have:
            \begin{align*}
            \nonumber \psi(\rho_0,\phi_0,\rho,\phi_s) &= kD\sqrt{1+\big(\rho^2+\rho_0^2 - 2\rho \rho_0 \cos(\phi - \phi_s)\big)/D^2 + \cos(B)\big(\rho_0\cos(\phi_0) - \rho\cos(\phi)\big)/D} - \\ &\bigg(1+\cos(B)(\rho_0\cos(\phi_0) - \rho\cos(\phi_s)\big)/D\bigg)
            \end{align*}
            Unfortunately, for all values of $\psi$, $\int_{-\infty}^{\infty} |e^{i\psi}|d\rho = \int_{-\infty}^{\infty} 1d\rho = +\infty$. So, we never have the case that $e^{i\psi} \in L^{1}(\mathbb{R})$. However, there are many examples of $\psi$'s such that this theorem still seems to work. Let $\psi = \frac{\pi}{2}\rho^2$, and let $T(\rho) = e^{-\psi}$. Then $T*e^{i\psi} = \int_{-\infty}^{\infty} e^{-\frac{\pi}{2}\rho^2}e^{i\frac{\pi}{2}(\rho_0-\rho)^2}d\rho = \sqrt{1+i}e^{-\frac{1+i}{4}\rho_0^2}$. And $\mathcal{F}_{\xi}\big(\sqrt{1+i}e^{-\frac{1+i}{4}\rho_0^2}\big) = \sqrt{2}(1+i)e^{-(1+i)2\pi \xi^2}$. Now, $\mathcal{F}_{\xi}(e^{-\frac{\pi}{2}\rho^2})\cdot \mathcal{F}_{\xi}(e^{i\frac{\pi}{2}\rho^2}) = \sqrt{2}e^{-2\pi \xi^2}(1+i)e^{-2\pi i \xi^2} = \sqrt{2}(1+i)e^{-(1+i)2\pi \xi^2}$. So we see that, even though $\psi \notin L^{1}(\mathbb{R})$, we still that the result still holds here. 
        \subsection{Window Width as a Function of Resolution}
            We start with the following definition for resolution.
            \begin{definition}
            The resolution of a reconstruction is:
            \begin{equation*}
                \Delta R=\frac{2F^{2}}{W_{eff}}\frac{\frac{b^2}{2}}{e^{-b}+b-1}=\frac{F^{2}}{W_{eff}}\frac{b^2}{e^{-b}+b-1}
            \end{equation*}
            Where $W_{eff}$ and $b$ have the following definitions:
            \begin{align*}
                W_{eff}&=\frac{W}{N_{eq}}&b&=\frac{\sigma^2\omega^2}{2\dot{\rho}}W_{eff}
            \end{align*}
            Here $N_{eq}$ is the normalized equivalent width, $\sigma$ is the Allen Deviation, $\omega$ is the angular frequency, and $\dot{\rho}=\frac{d\rho}{dt}$, where $\rho(t)$ is the ring radius of the ring intercept point. Let $\alpha = \frac{\sigma^2 \omega^2}{2\dot{\rho}}$. Then $b = \alpha W_{eff}$. So:
            \begin{equation*}
            R = \frac{F^2}{W_{eff}}\frac{\alpha^2 W_{eff}^2}{e^{-\alpha W_{eff}}+\alpha W_{eff}-1} = \alpha F^2 \frac{\alpha W_{eff}}{e^{-\alpha W_{eff}}+\alpha W_{eff} - 1}
            \end{equation*}
            Let $f(x) = xe^{x}$. Then for $x\in \mathbb{R}^{+}$, $f^{-1}(x)$ exists and $f^{-1}(x) = L_{W}(x)$, where $L_{W}(x)$ is the Lambert W Function. Using $b$ again, we have:
            \begin{equation*}
                \Delta R = \alpha F^2 \frac{b}{e^{-b}+b-1}\Rightarrow \frac{R}{\alpha F^2} = \frac{b}{e^{-b}+b-1}
            \end{equation*}
            Letting $y = \frac{\Delta R}{\alpha F^2}$, we have:
            \begin{equation*}
                y = \frac{b}{e^{-b}+b-1}
            \end{equation*}
            This is invertable in terms of $L_{W}$:
            \begin{equation*}
                b = L_{W}\bigg(\frac{y}{1-y}e^{\frac{y}{1-y}}\bigg) - \frac{y}{1-y}
            \end{equation*}
            \end{definition}
        \subsection{The Forward Model}
            Given a plane wave of wavelength $\lambda$
            travelling in the $\mathbf{\hat{u}}_{i}$ direction
            incident on a thin plane screen, with plane angle $B$,
            the complex transmittance at the point
            $\boldsymbol{\uprho_{0}}=(\rho_{0},\phi_{0})$ measured
            by an observer at the point $\mathbf{R_{c}}$ can be
            modelled by the following equation:
            \begin{equation}
                \hat{T}(\boldsymbol{\uprho_{0}})
                =\frac{\sin(B)}
                      {i\lambda}
                \int_{0}^{2\pi}\int_{0}^{\infty}
                    T(\boldsymbol{\rho})
                    e^{%
                        ik\mathbf{\hat{u}}_{i}\cdot
                        (\boldsymbol{\uprho}-\mathbf{R_{c}})
                    }
                    \frac{%
                        e^{%
                            ik\norm{%
                                \mathbf{R_{c}}
                                -\boldsymbol{\uprho}
                            }
                        }
                    }{%
                        \norm{%
                            \mathbf{R_{c}}
                            -\boldsymbol{\uprho}
                        }
                    }
                    \rho{d}\rho{d}\phi
            \end{equation}
            Where $\boldsymbol{\uprho}=(\rho,\phi)$ and $k$
            is the wavenumber $k=\frac{2\pi}{\lambda}$. If
            $\mathbf{R_{c}}$ does not lie in the plane of the
            screen, and if the transmittance
            $T(\boldsymbol{\uprho})$ is bounded, then this
            integral converges. If we let
            $\mathbf{D}=\mathbf{R_{c}}-\boldsymbol{\uprho_{0}}$,
            then we can collect all of the exponential terms
            together as:
            \begin{equation}
                \begin{split}
                    \psi(\rho_{0},\phi_{0};\rho,\phi)
                    =kD\Bigg[%
                        \sqrt{1+2\cos(B)
                        \frac{%
                            \rho_{0}\cos(\phi_{0})
                            -\rho\cos(\phi)
                        }{D}
                        +\frac{%
                            \rho^{2}+\rho_{0}^{2}
                            -2\rho\rho_{0}\cos(\phi-\phi_{0})
                        }{D^2}}\\
                        -\bigg(
                            1+\cos(B)
                            \frac{%
                                \rho_{0}\cos(\phi_{0})
                                -\rho\cos(\phi)
                            }{D}
                        \bigg)
                    \Bigg]
                \end{split}
            \end{equation}
            The integral becomes:
            \begin{equation}
                \hat{T}(\boldsymbol{\uprho_{0}})
                =\frac{\sin(B)}{i\lambda}
                 \int_{0}^{2\pi}\int_{0}^{\infty}\rho
                 T(\boldsymbol{\uprho})
                 \frac{%
                    e^{i\psi(\rho_{0},\phi_{0};\rho,\phi)}
                }{%
                    \norm{\mathbf{R_{c}}-\boldsymbol{\uprho}}
                }d\rho{d}\phi    
            \end{equation}
            We impose that $T$ is non-negative
            (There's no such thing as 'negative' transmittance).
            From this we may use a complex version of Funini's
            theorem to obtain:
            \begin{equation}
                \hat{T}(\boldsymbol{\uprho_{0}})
                =\frac{\sin(B)}{i\lambda}\int_{0}^{\infty}\rho T(\boldsymbol{\uprho})\int_{0}^{2\pi}\frac{e^{i\psi(\rho_{0},\phi_{0};\rho,\phi)}}{\norm{\mathbf{R_{c}}-\boldsymbol{\uprho}}}d\phi d\rho
            \end{equation}
                In general, this is as far as one can simplify the problem. For ring systems, which we are studying, we can suppose that $T(\boldsymbol{\uprho})=T(\uprho)$. That is, the screen is radially symmetric. The task is, given the data $\hat{T}(\boldsymbol{\uprho})$, can we determine $T(\uprho)$? Unfortunately, we don't have an entire planar set of data, but rather some curve. The need then arises to try to collapse this problem down to a single integral by some means of approximation. The Stationary Phase Approximation works here.
        \subsection{Notes on the Fresnel Approximation}
            \begin{align*}
                \psi
                &=\bigg(
                      1+\frac{%
                          \rho^{2}+\rho_{0}^{2}
                          -2\rho\rho_{0}\cos(\phi-\phi_{0})
                      }{D^{2}}
                      -2\cos(B)\big(
                          \frac{%
                              \rho\cos(\phi)
                              -\rho_{0}\cos(\phi_{0})
                          }{D}
                      \big)
                  \bigg)^{1/2}\\
                &-(1-\cos(B)\big(\frac{\rho\cos(\phi)-\rho_{0}
                  \cos(\phi_{0})}{D})\\
                &=\sqrt{1+\eta-2\xi}-(1-\xi)\\
                  \Rightarrow\frac{\partial\psi}{\partial\phi}
                &=\frac{1}{2\sqrt{1+\eta-2\xi}}
                  \big(
                      \frac{\partial\eta}{\partial\phi}
                      -2\frac{\partial\xi}{\partial\phi}
                  \big)+\frac{\partial\xi}{\partial\phi}\\
                \Rightarrow
                \frac{\partial^{2}\psi}{\partial\phi^{2}}
                &=\frac{-1}{4(1+\eta-2\xi)^{3/2}}
                  \big(
                      \frac{\partial\eta}{\partial\phi}
                      -2\frac{\partial\xi}{\partial\phi}
                  \big)^{2}
                      +\frac{1}{2\sqrt{1+\eta-2\xi}}
                  \big(
                      \frac{\partial^{2}\eta}{\partial\phi^{2}}
                      -2\frac{\partial^{2}\xi}{\partial\phi^{2}}
                  \big)
                +\frac{\partial^{2}\xi}{\partial\phi^{2}}
            \end{align*}
            Now, from the definitions of $\eta$ and $\xi$,
            we have:
            \begin{align*}
                \eta_{\phi=\phi_{0}}
                &=\big(\frac{\rho-\rho_{0}}{D}\big)^{2}
                &
                \xi_{\phi=\phi_{0}}
                &=\cos(B)\cos(\phi_{0})
                  \big(\frac{\rho-\rho_{0}}{D}\big)\\
                \frac{\partial\eta}
                     {\partial\phi}_{\phi=\phi_{0}}
                &=0
                &
                \frac{\partial\xi}
                     {\partial\phi}_{\phi=\phi_{0}}
                &=-\cos(B)\frac{\rho\sin(\phi_{0})}{D}\\
                \frac{\partial^{2}\eta}
                     {\partial\phi^{2}}_{\phi=\phi_{0}}
                &=\frac{2\rho\rho_{0}}{D^{2}}
                &
                \frac{\partial^{2}\xi}
                     {\partial\phi^{2}}_{\phi=\phi_{0}}
                &=-\cos(B)\frac{\rho\cos(\phi_{0})}{D}
            \end{align*}
            Let $\alpha=\cos(B)\cos(\phi_{0})$ and
            $x=(\frac{\rho-\rho_{0}}{D})^{2}$.
            From this, we obtain:
            \begin{align*}
                \psi_{\phi=\phi_{0}}
                &=\sqrt{1+x^{2}-2\alpha{x}}+\alpha{x}-1\\
                \frac{\partial\psi}
                     {\partial\phi}_{\phi=\phi_{0}}
                &=\cos(B)\sin(\phi_{0})\frac{\rho}{D}
                \bigg(
                    \frac{1}{\sqrt{1+x^{2}-2\alpha{x}}}-1
                \bigg)\\
                \frac{\partial^{2}\psi}
                     {\partial\phi^{2}}_{\phi=\phi_{0}}
                &=\frac{%
                      -\rho^{2}\cos^{2}(B)\sin^{2}(\phi_{0})
                  }{%
                    D^{2}(1+x^{2}-2\alpha{x})^{3/2}
                  }
                  +\frac{\rho\rho_{0}}
                        {D^{2}(1+x^{2}-2\alpha{x})^{1/2}}
                  +\frac{\alpha\rho}{D}
                  \bigg(\frac{1}{\sqrt{1+x^{2}-2\alpha{x}}}-1\bigg)
            \end{align*}
            A nice property emerges here related to
            Legendre polynomials. The following is true:
            \begin{equation*}
                \frac{1}{\sqrt{1-2\alpha{x}+x^{2}}}
                =\sum_{n=0}^{\infty}P_{n}(\alpha)x^{n}
            \end{equation*}
            Where $P_{n}(\alpha)$ is the $n^{th}$
            Legendre polynomial. That is, this is
            the \textit{generating function} for the
            Legendre polynomials. Using this we can
            easily compute the Taylor series expansions
            for $\psi$ and $\psi_{\phi}$ about $x=0$.
            $\psi_{\phi\phi}$ is a nastier type of monster.
            Using this, we obtain the following equations:
            \begin{align*}
                \psi_{\phi=\phi_{0}}
                &=\frac{1-\alpha^{2}}{2}x^{2}
                 +\frac{\alpha(1-\alpha^{2})}{3}x^{3}
                 +\frac{-5\alpha^{4}+6\alpha^{2}-1}{8}x^{4}+
                 \hdots\\
                  \frac{\partial\psi}
                       {\partial\phi}_{\phi=\phi_{0}}
                &=\cos(B)\sin(\phi_{0})\frac{\rho}{D}
                  \bigg(
                      \alpha{x}+\frac{3\alpha^{2}-1}{2}x^{2}
                      +\frac{35\alpha^{4}-30\alpha^{2}+3}{8}x^{4}
                      +\hdots
                  \bigg)
            \end{align*}
            We wish to find the point $\phi$ for which
            $\psi_{\phi}=0$. We can use Newton-Raphson
            with initial guess
            $\phi=\phi_{0}$. Note that, from analyticity:
            \begin{equation*}
                \psi=\sum_{k=0}^{\infty}
                     \psi^{(k)}(\phi=\phi_{s})
                     \frac{(\phi-\phi_{s})^{k}}{k!}
                    =\psi_{s}+\psi'_{s}(\phi-\phi_{s})
                    +\frac{1}{2}\psi''_{s}(\phi-\phi_{s})^{2}
                    +\hdots
            \end{equation*}
            Where all derivatives are taken with respect to
            $\phi$, and $\psi_{s}$ denotes the derivatives
            evaluated at $\phi=\phi_{s}$.
            We may form a sequence of points and
            functions defined by
            the Newton-Raphson method as follows:
            \begin{align*}
                \phi_{n+1}&=\phi_{n}-\psi'_{n}/\psi''_{n}\\
                \psi&\approx
                \psi_{n}+\psi'_{n}(\phi_{n+1}-\phi_{n})
                +\frac{1}{2}\psi''_{n}(\phi_{n+1}-\phi_{n})^{2}\\
                &=\psi_{n}+\psi'(-\psi'_{n}/\psi''_{n})
                 +\frac{1}{2}
                  \psi''_{n}(-\psi'_{n}/\psi''_{n})^{2}\\
                &=\psi_{n}-\frac{1}{2}\psi'^{2}_{n}/\psi''_{n}
            \end{align*}
            Now, let's use the equations we've found before
            to evaulate the first iteration of this
            approximation. First we only consider the
            leading terms of each expansion. The leading term
            of $\partial^{2}\psi/\partial\phi^{2}$ occurs
            when we evaluate at $x=0$. This occurs only
            when $\rho=\rho_{0}$. From this, we have the
            following:
            \begin{align*}
                \psi_{\phi=\phi_{0}}
                &\approx
                    \frac{1}{2}\big(
                        1-\cos^{2}(B)\cos^{2}(\phi_{0})
                    \big)
                    \Big(\frac{\rho-\rho_{0}}{D}\Big)^{2}\\
                \frac{\partial\psi}
                     {\partial\phi}_{\phi=\phi_{0}}
                &\approx
                    \cos^{2}(B)\sin(\phi_{0})\cos(\phi_{0})
                    \frac{\rho}{D}
                    \Big(\frac{\rho-\rho_{0}}{D}\Big)\\
                \frac{\partial^{2}\psi}
                     {\partial\phi^{2}}_{\phi=\phi_{0}}
                &\approx
                    \big(1-\cos^{2}(B)\sin^{2}(\phi_{0})\big)
                    \Big(\frac{\rho_{0}}{D}\Big)^{2}
            \end{align*}
            From this, the first approximation becomes:
            \begin{align*}
                \phi_{1}
                &=\phi_{0}-
                \frac{\cos^{2}(B)\sin(\phi_{0})\cos(\phi_{0})}
                     {1-\cos^{2}(B)\sin^{2}(\phi_{0})}
                \frac{\rho}{\rho_{0}}
                \Big(\frac{\rho-\rho_{0}}{\rho_{0}}\Big)\\
                \psi
                &\approx
                    \frac{1}{2}\big(
                        1-\cos^{2}(B)\cos^{2}(\phi_{0})
                    \big)
                    \Big(\frac{\rho-\rho_{0}}{D}\Big)^{2}
                    -
                    \frac{1}{2}
                    \frac{%
                        \cos^{4}(B)\sin^{2}(\phi_{0})
                        \cos^{2}(\phi_{0})
                    }{
                    1-\cos^{2}(B)\sin^{2}(\phi_{0})}
                    \frac{\rho^{2}}{\rho_{0}^{2}}
                \Big(\frac{\rho-\rho_{0}}{D}\Big)^{2}\\
                &\approx
                \frac{\sin^{2}(B)}
                     {1-\cos^{2}(B)\sin^{2}(\phi_{0}}
                \Big(\frac{\rho-\rho_{0}}{D}\Big)^{2}
            \end{align*}
            The second approximation comes from the fact
            that we have assumed that
            $\rho^{2}/\rho_{0}^{2}\approx{1}$
            in the algebra for this final expression. When
            we apply the weight of $kD$, where $k$ is the
            wavenumber, we get the classic Fresnel
            approximation:
            \begin{align*}
                \psi_{Q}&=\frac{\pi}{2}
                \Big(\frac{\rho-\rho_{0}}{F}\Big)^{2}
                &
                F^{2}&=
                \frac{\lambda{D}}{2}
                    \frac{1-\cos^{2}(B)\sin^{2}(\phi_{0})}
                         {\sin^{2}(B)}
            \end{align*}
            This gives us a quadratic approximation that is
            both very easy to compute and gives decent
            diffraction reconstructions for many 
            occultation observations. In particular,
            this applies very well to the
            Rev007E Cassini occultation. During more
            pathalogical geometries, there is a need to use
            a better approximation and to use
            higher order terms. For ease of analyis, and
            to better take advantage of these Legendre
            polynomials, we will continue to use
            the approximation that
            $\rho^{2}/\rho_{0}^{2}\approx{1}$.
            Since $\rho_{0}$ is usually greater
            than 65,000 (Radius of Saturn) and
            $\rho-\rho_{0}$ is bounded by the window width,
            the worst case scenario one could reasonably
            expect is 4,000 kilometer windows, in which
            case the ratio is bounded by 1.06. For
            10,000 kilometer windows the ratio is bounded
            by 1.14. The appoximation can thus be
            generalized to:
            \begin{equation*}
                \psi\approx
                \sum_{k=0}^{N-1}b_{k}x^{k+2}
                -\frac{1}{2}
                \frac{\cos^{2}(B)\sin^{2}(\phi_{0})}
                     {1-\cos^{2}(B)\sin^{2}(\phi_{0})}
                \Big(\sum_{k=1}^{N}P_{k}(\alpha)x^{n}\Big)^{2}
            \end{equation*}
            Where $b_{k}$ is the $k^{th}$ term of the expansion
            for $\psi$, and $P_{n}$ is the $n^{th}$
            Legendre Polynomial. When $N=1$, we obtain
            the Fresnel approximation we previously
            derived. It would be convenient if we could
            write the $b_{k}$ in terms of the
            $P_{k}(\alpha)$. We can do this by solving the
            following simple differential equation.
            \begin{align*}
                \frac{d}{dx}
                \Big(\sqrt{1+x^{2}-\alpha{x}}\Big)
                &=\frac{x-\alpha}{\sqrt{1+x^{2}-\alpha{x}}}\\
                &=(x-\alpha)
                  \sum_{k=0}^{\infty}P_{k}(\alpha)x^{k}\\
                &=\sum_{k=0}^{\infty}P_{k}(\alpha)x^{k+1}
                 -\alpha\sum_{k=0}^{\infty}P_{k}(\alpha)x^{k}\\
                \Rightarrow
                \sqrt{1+x^{2}-2\alpha{x}}
                &=1+\sum_{k=0}^{\infty}P_{k}(\alpha)
                    \frac{x^{k+2}}{k+2}
                 -\alpha\sum_{k=0}^{\infty}P_{k}(\alpha)
                  \frac{x^{k+1}}{k+1}\\
                \Rightarrow
                \sqrt{1+x^{2}-2\alpha{x}}+\alpha{x}-1
                &=\sum_{k=0}^{\infty}
                    \Big(
                        P_{k}(\alpha)-\alpha{P_{k+1}}(\alpha)
                    \Big)
                    \frac{x^{k+2}}{k+2}
            \end{align*}
            Where we used a shift of index to obtain the last
            equation. This gives us our formula:
            \begin{equation*}
                b_{k}=\frac{P_{k}(\alpha)-\alpha{P}_{k+1}(\alpha)}{k+2}
            \end{equation*}
            We have the following first order approximation
            for $\psi$. Higher order approximations can be
            computed by evaluating
            $\psi_{n}-\psi_{n}'^{2}/\psi_{n}''$
            at better approximations obtained by the
            Newton-Raphson method for $\psi$.
            \begin{equation*}
                \psi\approx
                \sum_{k=0}^{N-1}
                \frac{P_{k}(\alpha)-\alpha{P}_{k+1}}{k+2}x^{k+2}
                -\frac{1}{2}
                \frac{\cos^{2}(B)\sin^{2}(\phi_{0})}
                     {1-\cos^{2}(B)\sin^{2}(\phi_{0})}
                \Big(\sum_{k=1}^{N}P_{k}(\alpha)x^{n}\Big)^{2}
            \end{equation*}
            In the cases where $\psi_{\phi\phi}$ can not be assumed
            constant, we need to keep track of the how it's Taylor
            expansion behaves beyond zeroth order. We have:
            \begin{align*}
                \frac{\partial^{2}\psi}
                     {\partial\phi^{2}}_{\phi=\phi_{0}}
                &=\frac{-\rho^{2}\cos^{2}(B)\sin^{2}(\phi_{0})}
                       {D^{2}(1+x^{2}-2\alpha{x})^{3/2}}
                  +\frac{\rho\rho_{0}}{D^{2}(1+x^{2}-2\alpha{x})^{1/2}}
                  +\frac{\alpha\rho}{D}
                  \Big(\frac{1}{\sqrt{1+x^{2}-2\alpha{x}}}-1\Big)\\
                &\approx\frac{\rho^{2}}{D^{2}}\bigg(
                    \frac{-\cos^{2}(B)\sin^{2}(\phi_{0})}
                         {(1+x^{2}-2\alpha{x})^{3/2}}+
                    \frac{1}{(1+x^{2}-2\alpha{x})^{1/2}}+
                    \frac{\alpha{D}}{\rho}
                    \Big(\frac{1}{\sqrt{1+x^{2}-2\alpha{x}}}-1\Big)
                \bigg)\\
                &\approx\frac{\rho^{2}}{D^{2}}\bigg(
                    \sum_{n=0}^{\infty}P_{n}(\alpha)x^{n}
                    \Big(1-\frac{\cos^{2}(B)\sin^{2}(\phi_{0})}
                                {1+x^{2}-2\alpha{x}}\Big)+
                    \frac{\alpha{D}}{\rho}
                    \Big(\sum_{n=1}^{\infty}P_{n}(\alpha)x^{n}\Big)
                \bigg)
            \end{align*}
            Where the approximation is because we have once again
            assumed that $\rho/\rho_{0}\approx{1}$. The ratio of
            $\psi'^{2}/\psi''$ then becomes:
            \begin{equation*}
                \frac{\psi'}{\psi''}_{\phi=\phi_{0}}\approx
                \frac{\cos^{2}(B)\sin^{2}(\phi_{0})
                      \Big(\sum_{k=1}^{N}P_{k}(\alpha)x^{n}\Big)^{2}}
                     {\sum_{n=0}^{\infty}P_{n}(\alpha)x^{n}
                      \Big(1-\frac{\cos^{2}(B)\sin^{2}(\phi_{0})}
                                  {1+x^{2}-2\alpha{x}}\Big)+
                      \frac{\alpha{D}}{\rho}
                      \Big(\sum_{n=1}^{\infty}P_{n}(\alpha)x^{n}\Big)}
            \end{equation*}
            Using the fact that $P_{0}(\alpha)=1$, we can simplify
            this to:
            \begin{equation*}
                \frac{\psi'}{\psi''}_{\phi=\phi_{0}}\approx
                \frac{\cos^{2}(B)\sin^{2}(\phi_{0})
                      \Big(\sum_{k=1}^{N}P_{k}(\alpha)x^{n}\Big)^{2}}
                     {\sum_{n=0}^{\infty}P_{n}(\alpha)x^{n}
                      \Big(1+\frac{\alpha{D}}{\rho}-
                           \frac{\cos^{2}(B)\sin^{2}(\phi_{0})}
                                {1+x^{2}-2\alpha{x}}\Big)-
                      \frac{\alpha{D}}{\rho}}
            \end{equation*}
            Stopping the sum at $n=0$, we retrieve our previous
            approximation. The only limitation to this approximation
            is the validity of $\rho/\rho_{0}\approx{1}$. In
            most cases, this is reasonable.

            %   k = kD/d
            %   x = r-r0
            %   d += -x
            %   d = d_km_vals[crange]
            %   d = d[::-1]
            %   d += 3564.0
            %   phi0 = phi_rad_vals[crange]
            %   d = d_km_vals[crange]
            %   d = np.sqrt(d*d+x*x-2.0*d*x*np.cos(b)*np.cos(phi0))
            %   d = np.sqrt(d*d+x*x-2.0*d*x*np.cos(b))
            %   d = np.sqrt(d*d + r0*r0 + r*r +
            %               2*d*np.cos(b)*(r0*np.cos(phi0)-r*np.cos(phi)) -
            %               2*r*r0*np.cos(phi-phi0))
            %   d += 6.451612903225806*(r0-r)
            %   b = B_rad_vals[crange]
            %   b += -1.065918653576764e-06*(r0-r)
            %   phi0 = phi_rad_vals[center]
            %   phi0 += -5.049088359056939e-06*(r0-r)
            %   phi0 = phi_rad_vals[crange]
            %   phi0 = phi - 2.291714213045173e-06*(r0-r)
            %   phi0 = 4.554515545218878
            %   phi = np.arange(phi_0-0.1,phi_0+0.1,0.00001)
            %   psi_vals = np.amin(psif(kD, r, r0[:,None], phi[None:,], phi0[:,None], b, d),axis=1)
            %   psi_phi = psif(kD, r, r0[:,None], phi1[None:,], phi0, b, d)
            %   phi = np.minimum(psi_phi)
            %   kD = k*d
            %   psi_d2 = d2psi(kD, r, r0, phi, phi0, b, d)
            %   Perturbation for Halley's Method.
            %   psi_d3 = d3psi(kD, r, r0, phi, phi0, b, d)
            %   psi_p = -2*psi_d1*psi_d2/(2.0*psi_d2*psi_d2-psi_d1*psi_d3)
            %   psi_p = -psi_d1/psi_d2
            %   psi_vals = psif(kD, r, r0, phi, phi0, b, d)
            %   psi_vals += psi_d1*psi_p
            %   psi_vals += psi_d2*psi_p*psi_p/2.0
            %   Cubic term of Taylor Expansion for psi.
            %   psi_vals += psi_d3*psi_p*psi_p*psi_p/6.0
            %   a = 5.528863171153257e-09
            %   x = r0-r
            %   psi_vals += -a*x*x*x*x
            %   dDdr = -(d_km_vals[center+1]-d_km_vals[center])/dx_km
            %   psi_vals += dDdr*kD*x*x*x
            
            %   a = 0.3*kD
            %   x = (r-r0)/d
            %   psi_vals += a*x*x*x

\end{document}